<UserControl x:Class="CoffeeManagement.StaffOrders"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:CoffeeManagement"
             Background="#F4F4F4">
    <UserControl.Resources>
        <SolidColorBrush x:Key="SuccessBrush" Color="#2E8B57"/>
        <SolidColorBrush x:Key="DangerBrush" Color="#D9534F"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="TextMutedBrush" Color="#6c757d"/>
        <Style x:Key="BaseButton" TargetType="Button">
            <Setter Property="Padding" Value="10,5"/>
            
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource BaseButton}">
            <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource BaseButton}">
            <Setter Property="Background" Value="{StaticResource DangerBrush}"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <ItemsControl x:Name="OrdersItemsControl" Margin="10">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="{StaticResource BorderBrush}" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        Padding="16" 
                        Margin="10" 
                        Width="380"
                        Background="White">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="1" Color="#000000" Opacity="0.1" BlurRadius="10"/>
                        </Border.Effect>

                        <StackPanel>
                            <TextBlock FontWeight="SemiBold" 
                                   FontSize="18"
                                   Text="{Binding Id, StringFormat='Order #{0}'}" />

                            <TextBlock Text="{Binding CreatedAt, StringFormat='Created: {0:G}'}" 
                                   FontSize="12" 
                                   Foreground="{StaticResource TextMutedBrush}"/>

                            <TextBlock FontSize="13" 
                                   Margin="0,4,0,0">
                            <Run Text="Customer: "/>
                            <Run Text="{Binding Customer.Username, FallbackValue='Guest'}" FontWeight="Medium"/>
                            </TextBlock>

                            <Border x:Name="NoteBorder"
                                CornerRadius="4" 
                                Background="#FFFBEB" 
                                BorderBrush="#FDE68A" 
                                BorderThickness="1" 
                                Margin="0,10,0,5" 
                                Padding="10">

                                <TextBlock Text="{Binding Note}"
                                       Foreground="#B45309"
                                       FontSize="13"
                                       TextWrapping="Wrap"
                                       FontStyle="Italic"
                                       FontWeight="Medium"/>

                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Note}" Value="{x:Null}">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Note}" Value="">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                            </Border>
                            <Separator Margin="0,12,0,8"/>

                            <TextBlock Text="Items:" FontWeight="Bold" Margin="0,0,0,4"/>
                            <ItemsControl ItemsSource="{Binding OrderItems}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,3,0,3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" 
                                                   Text="{Binding MenuItem.Name}" 
                                                   TextWrapping="Wrap"
                                                   VerticalAlignment="Center"/>

                                            <TextBlock Grid.Column="1" 
                                                   Text="{Binding Quantity, StringFormat='x{0}'}" 
                                                   Margin="10,0,0,0"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource TextMutedBrush}"/>

                                            <TextBlock Grid.Column="2" 
                                                   Text="{Binding UnitPrice, StringFormat=' {0:C0}'}" 
                                                   Margin="10,0,0,0"
                                                   TextAlignment="Right"
                                                   FontWeight="Medium"
                                                   VerticalAlignment="Center"/>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <Separator Margin="0,8,0,12"/>

                            <TextBlock Text="{Binding TotalAmount, StringFormat='Total: {0:C0}'}" 
                                   FontWeight="Bold" 
                                   FontSize="16"
                                   HorizontalAlignment="Right"
                                   Margin="0,0,0,12"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Button Grid.Column="0"
                                    Content="Mark Complete Paid" 
                                    Click="BtnMarkComplete_Click" 
                                    Margin="0,0,4,0"
                                    Style="{StaticResource SuccessButton}"/>

                                <Button Grid.Column="1"
                                    Content="Reject" 
                                    Click="BtnReject_Click" 
                                    Margin="4,0,0,0"
                                    Style="{StaticResource DangerButton}"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </ScrollViewer>
</UserControl>